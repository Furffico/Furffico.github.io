<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Deep Q-Learning Algorithm & Experience Replay"><title>ã€RLå­¦ä¹ ç¬”è®°ã€‘æ·±åº¦Qå­¦ä¹ ç®—æ³•ä¸ç»éªŒå›æ”¾</title>
<link rel=canonical href=https://blog.furffisite.link/p/deep-q-learning/><link rel=stylesheet href=/scss/style.min.1d9acc6d7417da29e26c03e15654a8a97a1eb01eaece9c154c7b2b3721fec799.css><meta property='og:title' content="ã€RLå­¦ä¹ ç¬”è®°ã€‘æ·±åº¦Qå­¦ä¹ ç®—æ³•ä¸ç»éªŒå›æ”¾"><meta property='og:description' content="Deep Q-Learning Algorithm & Experience Replay"><meta property='og:url' content='https://blog.furffisite.link/p/deep-q-learning/'><meta property='og:site_name' content='Furffiblog'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='æœºå™¨å­¦ä¹ '><meta property='article:tag' content='å¼ºåŒ–å­¦ä¹ '><meta property='article:published_time' content='2023-08-22T10:51:10+08:00'><meta property='article:modified_time' content='2023-08-22T10:51:10+08:00'><meta property='og:image' content='https://files.furffisite.link/blogimg/20230822110113-5ef18ab6cfb63d5a730bbd8e077231e7-6ba69.jpg'><meta name=twitter:title content="ã€RLå­¦ä¹ ç¬”è®°ã€‘æ·±åº¦Qå­¦ä¹ ç®—æ³•ä¸ç»éªŒå›æ”¾"><meta name=twitter:description content="Deep Q-Learning Algorithm & Experience Replay"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://files.furffisite.link/blogimg/20230822110113-5ef18ab6cfb63d5a730bbd8e077231e7-6ba69.jpg'><link rel=preconnect href=https://files.furffisite.link crossorigin><link rel=preconnect href=https://gfonts.aby.pub crossorigin><script async src=https://analytics.umami.is/script.js data-website-id=b3257363-e219-4eac-b59d-d75b9aba64b5></script><link href=https://files.furffisite.link/fontcache/NotoSansSC_Mulish_remote.min.css rel=preload as=style><link href=https://gfonts.aby.pub/s/mulish/v13/1Ptyg83HX_SGhgqO0yLcmjzUAuWexZNR8aevGw.woff2 rel=preload as=font><style>:root{--zh-font-family:"Noto Sans SC", "PingFang SC", "Hiragino Sans GB", "Droid Sans Fallback", "Microsoft YaHei";--base-font-family:"Mulish", var(--sys-font-family), var(--zh-font-family), sans-serif}</style></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8a7a5e24c6afd9e1fde1d549095c0023_459346_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ—‘ï¸</span></figure><div class=site-meta><h1 class=site-name><a href=/>Furffiblog</a></h1><h2 class=site-description>éšä¾¿å†™å†™</h2></div></header><ol class=menu-social><li><a href=https://github.com/furffico target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>ä¸»é¡µ</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li><a href=/gallery/><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32"><g fill="none"><path d="M3 7a4 4 0 014-4h14a4 4 0 014 4v14a4 4 0 01-4 4H7a4 4 0 01-4-4V7zm4-2A2 2 0 005 7v14a2 2 0 00.077.552l7.32-6.914c.9-.85 2.306-.85 3.205.0l7.32 6.914A2 2 0 0023 21V7a2 2 0 00-2-2H7zm0 18h14c.166.0.328-.02.482-.058l-7.253-6.85a.333.333.0 00-.458.0l-7.253 6.85c.155.038.316.058.482.058zm11.5-11a1.5 1.5.0 100-3 1.5 1.5.0 000 3zm-8 16.5a3.998 3.998.0 01-3.465-2H21a5.5 5.5.0 005.5-5.5V7.035c1.196.692 2 1.984 2 3.465V21A7.5 7.5.0 0121 28.5H10.5z" fill="currentcolor"/></g></svg>
<span>ç›¸å†Œ</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>æ–‡ç« å½’æ¡£</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#æ·±åº¦qå­¦ä¹ ç®—æ³•>æ·±åº¦Qå­¦ä¹ ç®—æ³•</a><ol><li><a href=#ç†è®º>ç†è®º</a></li><li><a href=#å®ç°>å®ç°</a></li></ol></li><li><a href=#ç»éªŒå›æ”¾>ç»éªŒå›æ”¾</a><ol><li><a href=#ç†è®º-1>ç†è®º</a></li><li><a href=#å®ç°-1>å®ç°</a></li></ol></li><li><a href=#å‚è€ƒæ–‡çŒ®>å‚è€ƒæ–‡çŒ®</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/deep-q-learning/><img src=https://files.furffisite.link/blogimg/20230822110113-5ef18ab6cfb63d5a730bbd8e077231e7-6ba69.jpg loading=lazy alt="Featured image of post ã€RLå­¦ä¹ ç¬”è®°ã€‘æ·±åº¦Qå­¦ä¹ ç®—æ³•ä¸ç»éªŒå›æ”¾"></a></div><div class=article-details><header class=article-category><a href=/categories/%E7%AC%94%E8%AE%B0/>ç¬”è®°</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/deep-q-learning/>ã€RLå­¦ä¹ ç¬”è®°ã€‘æ·±åº¦Qå­¦ä¹ ç®—æ³•ä¸ç»éªŒå›æ”¾</a></h2><h3 class=article-subtitle>Deep Q-Learning Algorithm & Experience Replay</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 22, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 6 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h2 id=æ·±åº¦qå­¦ä¹ ç®—æ³•>æ·±åº¦Qå­¦ä¹ ç®—æ³•</h2><h3 id=ç†è®º>ç†è®º</h3><p>æ·±åº¦Qå­¦ä¹ ç®—æ³•ï¼ˆDeep Q-Learning Algorithmï¼‰æ˜¯å°† Q è¡¨æ ¼æ›¿æ¢ä¸ºç¥ç»ç½‘ç»œçš„ Q å­¦ä¹ ç®—æ³•ï¼Œç”± DeepMind çš„ Mnih et al. <sup><a id=ref-cite1-1 href=#cite1>[1]</a></sup><sup><a id=ref-cite2-1 href=#cite2>[2]</a></sup>æå‡ºã€‚
Qè¡¨æ ¼æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•° $f: S\times A \rightarrow \mathbb{R}$ï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ç¥ç»ç½‘ç»œæ„é€ è¿™ä¸ªå‡½æ•°ï¼Œè®©å®ƒå¯ä»¥å¤„ç†è¿ç»­çš„çŠ¶æ€å’ŒåŠ¨ä½œã€‚æ­¤å¤–ï¼Œä½¿ç”¨ç¥ç»ç½‘ç»œè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼šæˆ‘ä»¬å¯ä»¥å‘ç¥ç»ç½‘ç»œè¾“å…¥å®ä¾‹ä¿¡æ¯ $m\in M$ ï¼Œä½¿ä¹‹å¯ä»¥è·¨å®ä¾‹å­¦ä¹ å‡½æ•° $f: M\times S\times A\rightarrow \mathbb{R}$ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒAgentå¯ä»¥å°†å…¶åœ¨å®ä¾‹ $m_1,<del>m_2,</del>\ldots~m_n$ä¸Š å­¦ä¹ åˆ°çš„ç»éªŒè¿ç§»åˆ°æœªæ›¾è§è¿‡çš„å®ä¾‹ $m_{n+1}$ ä¸Šï¼Œå¢å¼ºæ¨¡å‹çš„æ³›åŒ–æ€§èƒ½ï¼Œå‡å°‘å…¶æ¢ç´¢æ–°å®ä¾‹æ‰€éœ€çš„æ—¶é—´ã€‚</p><p>ç½‘ç»œæ›´æ–°æ–¹ç¨‹çš„è®¾è®¡
ï¼ˆä»¥ <a class=link href=https://en.wikipedia.org/wiki/Bellman_equation target=_blank rel=noopener>Bellman æ–¹ç¨‹</a> ä¸ºåŸºç¡€ï¼‰ï¼š
$$Q(s_t, a_t) \leftarrow (1-\eta) Q(s_t, a_t) + \eta(\gamma\max_{j\in A} Q(s_{t+1}, j) + r_t)$$</p><p>æ±‚æ›´æ–°å‰ä¸æ›´æ–°åçš„å·®åˆ†ï¼š
$$\Delta Q(s_t, a_t) = -\eta Q(s_t, a_t) + \eta(\gamma\max_{j\in A} Q(s_{t+1},j) + r_t)$$</p><p>å³ï¼š
$$\Delta Q(s_t, a_t) = \eta(\gamma\max_{j\in A} Q(s_{t+1},j) + r_t - Q(s_t, a_t))$$</p><p>åœ¨ç†æƒ³æƒ…å†µä¸‹å……åˆ†è®­ç»ƒæ—¶ï¼Œåº”å½“æœ‰
$$\lim_{t\rightarrow \infty}\Delta Q(s_t, a_t) = 0$$</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè®­ç»ƒçš„ç›®æ ‡åº”å½“æ˜¯æœ€å°åŒ– $\Delta Q(s_t, a_t)$ï¼Œå³ç›®æ ‡å‡½æ•°ä¸ºï¼š
$$L(\theta) = \mathrm{MSE}(Q(s_t, a_t),~\gamma\max_{j\in A} Q(s_{t+1},j) + r_t)$$
å…¶ä¸­çš„ $\mathrm{MSE}$ ä¹Ÿå¯ä»¥æ›¿æ¢ä¸ºå…¶å®ƒçš„æŸå¤±å‡½æ•°ã€‚</p><h3 id=å®ç°>å®ç°</h3><p>ä¸‹é¢ä»¥<a class=link href=https://gymnasium.farama.org/environments/classic_control/cart_pole/ target=_blank rel=noopener>CartPole-v1ç¯å¢ƒ</a>ä¸ºä¾‹ç¼–å†™è®­ç»ƒç¨‹åºã€‚</p><p>å¼•å…¥ç›¸å…³çš„åº“ä»¥åŠå®šä¹‰ä¸€äº›è¶…å‚æ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>random</span><span class=p>,</span> <span class=n>randint</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gymnasium</span> <span class=k>as</span> <span class=nn>gym</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch.nn</span> <span class=k>as</span> <span class=nn>nn</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n_actions</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>n_states</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>lr</span> <span class=o>=</span> <span class=mf>3e-4</span>
</span></span><span class=line><span class=cl><span class=n>discount</span> <span class=o>=</span> <span class=mf>0.95</span>
</span></span><span class=line><span class=cl><span class=n>batch_size</span> <span class=o>=</span> <span class=mi>128</span>
</span></span><span class=line><span class=cl><span class=n>epochs</span> <span class=o>=</span> <span class=mi>5000</span>
</span></span></code></pre></td></tr></table></div></div><p>å®šä¹‰ç¥ç»ç½‘ç»œï¼Œè¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªç®€å•çš„ä¸‰å±‚ç¥ç»ç½‘ç»œï¼Œå…¶ä¸­è¾“å‡ºå±‚æ²¡æœ‰æ·»åŠ æ¿€æ´»å‡½æ•°æ˜¯å› ä¸ºæ¿€æ´»å‡½æ•°ä¼šé™åˆ¶ç½‘ç»œçš„å€¼åŸŸè‡³ $R_{act}$ ï¼Œè®¾Qå‡½æ•°çš„å€¼åŸŸæ˜¯ $R_Q$ï¼Œ$R_Q\nsubseteq R_{act}$ æ—¶æŸå¤±å‡½æ•°éš¾ä»¥æ”¶æ•›ï¼Œå½±å“è®­ç»ƒæ•ˆæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Net</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Sequential</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>norm_vector</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>([</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>0.21</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>in_feats</span> <span class=o>=</span> <span class=n>n_states</span><span class=p>,</span> <span class=n>out_feats</span> <span class=o>=</span> <span class=n>n_actions</span><span class=p>,</span> <span class=n>hidden</span> <span class=o>=</span> <span class=mi>32</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>in_feats</span><span class=p>,</span> <span class=n>hidden</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>nn</span><span class=o>.</span><span class=n>SiLU</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>hidden</span><span class=p>,</span> <span class=n>hidden</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>nn</span><span class=o>.</span><span class=n>SiLU</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>hidden</span><span class=p>,</span> <span class=n>out_feats</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>state</span><span class=o>/</span><span class=bp>self</span><span class=o>.</span><span class=n>norm_vector</span> <span class=c1># å½’ä¸€åŒ–</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>y</span>
</span></span></code></pre></td></tr></table></div></div><p>å®šä¹‰ç½‘ç»œã€ä¼˜åŒ–å™¨ä¸æŸå¤±å‡½æ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>net</span> <span class=o>=</span> <span class=n>Net</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>optimizer</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>optim</span><span class=o>.</span><span class=n>AdamW</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=n>lr</span><span class=o>=</span><span class=n>lr</span><span class=p>,</span> <span class=n>amsgrad</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>criterion</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>SmoothL1Loss</span><span class=p>()</span> <span class=c1># å‘ç°L1çš„æ•ˆæœæ¯”L2è¦å¥½</span>
</span></span></code></pre></td></tr></table></div></div><p>è®­ç»ƒè¿‡ç¨‹ï¼ˆåŸç¯å¢ƒæä¾›çš„ reward æ’ä¸º 1ï¼Œä¿¡æ¯å¤ªå°‘ï¼Œå› æ­¤è¿™é‡Œæ”¹ç”¨è‡ªå®šä¹‰çš„ rewardï¼Œåœ¨å€¾è§’è¿‡å¤§æˆ–ä½ç½®è¿‡è¿œæ—¶è¿›è¡Œæƒ©ç½šï¼‰ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>env</span> <span class=o>=</span> <span class=n>gym</span><span class=o>.</span><span class=n>make</span><span class=p>(</span><span class=s2>&#34;CartPole-v1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>epochs</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=c1># å‰å‘ä¼ æ’­</span>
</span></span><span class=line><span class=cl>    <span class=n>loss</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>    <span class=n>epsilon</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>t</span> <span class=o>/</span> <span class=n>epochs</span>  <span class=c1># åŠ¨æ€è°ƒæ•´epsilon</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># é€‰æ‹©action =========================</span>
</span></span><span class=line><span class=cl>        <span class=n>row</span> <span class=o>=</span> <span class=n>net</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>random</span><span class=p>()</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>:</span> <span class=c1># exploration</span>
</span></span><span class=line><span class=cl>            <span class=n>action</span> <span class=o>=</span> <span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>n_actions</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>action</span> <span class=o>=</span> <span class=n>row</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span><span class=o>.</span><span class=n>argmax</span><span class=p>()</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># æ‰§è¡Œaction =========================</span>
</span></span><span class=line><span class=cl>        <span class=n>state</span><span class=p>,</span> <span class=n>reward</span><span class=p>,</span> <span class=n>terminated</span><span class=p>,</span> <span class=n>truncated</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>action</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ä½¿ç”¨è‡ªå®šä¹‰çš„reward</span>
</span></span><span class=line><span class=cl>        <span class=n>reward</span> <span class=o>=</span> <span class=o>-</span><span class=mf>20.0</span> <span class=k>if</span> <span class=n>terminated</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mf>0.1</span><span class=p>:</span> <span class=c1># é™åˆ¶å€¾è§’</span>
</span></span><span class=line><span class=cl>            <span class=n>reward</span> <span class=o>+=</span> <span class=o>-</span><span class=mf>1.0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mf>0.3</span><span class=p>:</span> <span class=c1># é™åˆ¶ä½ç½®</span>
</span></span><span class=line><span class=cl>            <span class=n>reward</span> <span class=o>+=</span> <span class=o>-</span><span class=mf>2.0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>reward</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>reward</span> <span class=o>=</span> <span class=mf>1.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># è®¡ç®—loss =========================</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>terminated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>curr_q</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>(</span><span class=n>reward</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>curr_q</span> <span class=o>=</span> <span class=n>net</span><span class=p>(</span><span class=n>state</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>*</span> <span class=n>discount</span> <span class=o>+</span> <span class=n>reward</span>
</span></span><span class=line><span class=cl>        <span class=n>loss</span> <span class=o>+=</span> <span class=n>criterion</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=n>action</span><span class=p>],</span> <span class=n>curr_q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>terminated</span> <span class=ow>or</span> <span class=n>truncated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>state</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># åå‘ä¼ æ’­</span>
</span></span><span class=line><span class=cl>    <span class=n>optimizer</span><span class=o>.</span><span class=n>zero_grad</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=n>loss</span><span class=o>/</span><span class=n>batch_size</span><span class=p>)</span><span class=o>.</span><span class=n>backward</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>utils</span><span class=o>.</span><span class=n>clip_grad_value_</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>optimizer</span><span class=o>.</span><span class=n>step</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>env</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># ä¿å­˜checkpoint</span>
</span></span><span class=line><span class=cl><span class=n>torch</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>state_dict</span><span class=p>(),</span> <span class=s2>&#34;cartpole.ckpt&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¨ç†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>env</span> <span class=o>=</span> <span class=n>gym</span><span class=o>.</span><span class=n>make</span><span class=p>(</span><span class=s2>&#34;CartPole-v1&#34;</span><span class=p>,</span> <span class=n>render_mode</span><span class=o>=</span><span class=s2>&#34;human&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>row</span> <span class=o>=</span> <span class=n>net</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>action</span> <span class=o>=</span> <span class=n>row</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>state</span><span class=p>,</span> <span class=n>reward</span><span class=p>,</span> <span class=n>terminated</span><span class=p>,</span> <span class=n>truncated</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>action</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>terminated</span> <span class=ow>or</span> <span class=n>truncated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>state</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>env</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œè¿è¡Œç¨‹åºåå¯ä»¥çœ‹åˆ°ç±»ä¼¼äºè¿™æ ·çš„åŠ¨ç”»ï¼Œè¯´æ˜è¿™ä¸ªç®—æ³•ä»¥åŠæˆ‘ä»¬ç¼–å†™çš„ç¨‹åºéƒ½æ˜¯æœ‰æ•ˆçš„ï¼š
<img src=https://files.furffisite.link/blogimg/20230822103327-b82b26346196384f1796cefbd4ab8948-db19f.gif loading=lazy></p><p>å®Œæ•´çš„ç¨‹åºè§<a class=link href=https://gist.github.com/Furffico/7ce3f2ef1dc0bc42536d2a178c5c5a92#file-cartpole-py target=_blank rel=noopener>Github Gist</a>ï¼Œæ¨¡å‹æƒé‡å¯ä»¥ä»<a class=link href=https://files.furffisite.link/files/cartpole.ckpt target=_blank rel=noopener>è¿™é‡Œ</a>ä¸‹è½½ï¼ˆè™½ç„¶è‡ªå·±è®­ç»ƒä¸€ä¸ªä¹Ÿä¸è´¹äº‹ï¼‰ã€‚</p><h2 id=ç»éªŒå›æ”¾>ç»éªŒå›æ”¾</h2><h3 id=ç†è®º-1>ç†è®º</h3><p>ä¸Šé¢çš„è®­ç»ƒ Q ç½‘ç»œçš„æ–¹å¼å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚</p><ol><li>æ ·æœ¬çš„åˆ©ç”¨ç‡ä½ï¼šæ¯æ¬¡é‡‡æ ·åªå¯¹åº”ä¸€æ¬¡å‰å‘ä¼ æ’­ï¼Œé‡‡æ ·å¾—åˆ°çš„æ ·æœ¬æœªè¢«å……åˆ†åˆ©ç”¨ï¼›</li><li>æ ·æœ¬çš„æ—¶åºå…³è”æ€§å¤§ï¼šæ¯æ¬¡é‡‡æ ·åœ¨æ—¶é—´ä¸Šæ˜¯é«˜åº¦ç›¸å…³çš„ï¼Œä¸Šä¸€æ¬¡é‡‡æ ·çš„æœ«çŠ¶æ€å°±æ˜¯ä¸‹ä¸€æ¬¡é‡‡æ ·çš„åˆå§‹çŠ¶æ€ï¼Œå½±å“è®­ç»ƒæ•ˆæœï¼›</li><li>è®­ç»ƒé€Ÿåº¦æ…¢ï¼šæ¯æ¬¡å‰å‘ä¼ æ’­åªä¼ æ’­ä¸€ç»„æ•°æ®ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚</li></ol><p>ä¸ºäº†ç¼“è§£ä¸Šè¿°é—®é¢˜ï¼ŒMnih et al.<sup><a id=ref-cite2-2 href=#cite2>[2]</a></sup> åœ¨æå‡ºæ·±åº¦ Q å­¦ä¹ çš„åŒæ—¶ä¹Ÿæå‡ºäº†ç»éªŒå›æ”¾ï¼ˆExperience Replayï¼‰ç­–ç•¥ã€‚
å…¶ä¸»è¦æ€æƒ³æ˜¯å°†é‡‡æ ·ä¸è®­ç»ƒåˆ†ç¦»ï¼Œé‡‡æ ·æ—¶åœ¨è®°å¿†ä¸­ä¿å­˜é‡‡æ ·çš„è®°å½•ï¼Œè®­ç»ƒæ—¶éšæœºä»è®°å¿†ä¸­é€‰å–æ ·æœ¬è¿›è¡Œå‰å‘ä¸åå‘ä¼ æ’­ï¼Œä»è€Œé™ä½æ ·æœ¬é—´çš„æ—¶åºå…³è”æ€§ä¸æé«˜æ ·æœ¬åˆ©ç”¨ç‡ã€‚</p><p>æ³¨æ„åˆ°åœ¨ç®—æ³•ä¸­ï¼Œæ¯ä¸€æ­¥è®­ç»ƒéœ€è¦å››ä¸ªå€¼ï¼šå½“å‰çŠ¶æ€ $s_t$ã€åŠ¨ä½œ $a_t$ã€å›æŠ¥ $r_t$ ä»¥åŠé‡‡å–åŠ¨ä½œåçš„çŠ¶æ€ $s_{t+1}$ï¼Œå› æ­¤æ¯ä¸€æ¬¡é‡‡æ ·ååªéœ€è¦åœ¨è®°å¿†ä¸­ä¿å­˜è¿™å››ä¸ªå€¼ï¼Œç§°ä¸º experience å››å…ƒç»„ $e_t=(s_t,~a_t,~r_t,~s_{t+1})$ã€‚</p><h3 id=å®ç°-1>å®ç°</h3><p>åº“ã€è¶…å‚æ•°ã€ç½‘ç»œç»“æ„ä»¥åŠæ¨ç†éƒ¨åˆ†å‡æ²¿ç”¨ä¸Šé¢çš„ä»£ç ä»¥ä¾¿æ¯”è¾ƒï¼Œåªæ›¿æ¢è®­ç»ƒéƒ¨åˆ†ï¼Œç„¶åæ–°å¢ Experience ç±»ä¸ Memory ç±»ç”¨äºå­˜å‚¨å’Œç®¡ç†æ ·æœ¬ã€‚
ä»¥ä¸‹æ˜¯ Experience ç±»ä¸ Memory ç±»çš„ä»£ç ï¼Œè¿™é‡Œä½¿ç”¨é˜Ÿåˆ—å­˜å‚¨æœ€æ–°çš„ <code>batch_size*10</code> æ¡è®°å½•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>NamedTuple</span><span class=p>,</span> <span class=n>Union</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Experience</span><span class=p>(</span><span class=n>NamedTuple</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;&#39;&#39;experienceå››å…ƒç»„&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>state</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span>
</span></span><span class=line><span class=cl>    <span class=n>action</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>reward</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>next_state</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Memory</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;&#39;&#39;å­˜å‚¨å›ºå®šæ•°é‡è®°å½•çš„é˜Ÿåˆ—&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>buffer_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>buffer_size</span> <span class=o>=</span> <span class=n>buffer_size</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>Experience</span><span class=p>,</span> <span class=kc>None</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>            <span class=o>=</span> <span class=p>[</span><span class=kc>None</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>buffer_size</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>append</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>exp</span><span class=p>:</span> <span class=n>Experience</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;&#39;&#39;å¢åŠ è®°å½•ï¼Œå¦‚æœbufferå·²æ»¡åˆ™æ›¿æ¢æœ€æ—©çš„è®°å½•&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>count</span><span class=o>%</span><span class=bp>self</span><span class=o>.</span><span class=n>buffer_size</span><span class=p>]</span> <span class=o>=</span> <span class=n>exp</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>sample</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;&#39;&#39;éšæœºé€‰å–kä¸ªexperienceï¼Œæ‰“åŒ…å¥½è¿”å›&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>count</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer_size</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pool</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span><span class=p>[:</span><span class=bp>self</span><span class=o>.</span><span class=n>count</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pool</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span>
</span></span><span class=line><span class=cl>        <span class=n>exp</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Experience</span><span class=p>]</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choices</span><span class=p>(</span><span class=n>pool</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=n>k</span><span class=p>)</span> <span class=c1># type: ignore</span>
</span></span><span class=line><span class=cl>        <span class=c1># æ‰“åŒ…æˆ Tensor</span>
</span></span><span class=line><span class=cl>        <span class=n>states</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>from_numpy</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>e</span><span class=o>.</span><span class=n>state</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>exp</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>actions</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>([</span><span class=n>e</span><span class=o>.</span><span class=n>action</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>exp</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>rewards</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>([</span><span class=n>e</span><span class=o>.</span><span class=n>reward</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>exp</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>next_states</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>from_numpy</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>e</span><span class=o>.</span><span class=n>next_state</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>exp</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>states</span><span class=p>,</span> <span class=n>actions</span><span class=p>,</span> <span class=n>rewards</span><span class=p>,</span> <span class=n>next_states</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>memory</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>(</span><span class=n>batch_size</span><span class=o>*</span><span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é‡‡æ ·çš„éƒ¨åˆ†ä¸åŸæ¥ç›¸åŒï¼Œè€Œåœ¨è®­ç»ƒçš„éƒ¨åˆ†ï¼Œå› ä¸ºè¿™é‡Œè®­ç»ƒæ—¶å‰å‘å’Œåå‘ä¼ æ’­éƒ½åªæœ‰ä¸€æ­¥ï¼Œæ‰€ä»¥åœ¨è®¡ç®—<code>target_q</code>æ—¶ä¸éœ€è¦åƒåŸæ–‡æ‰€è¿°å†»ç»“æƒé‡ï¼Œåªè¦åœ¨å…¶åå¢åŠ <code>.detach()</code>ç¡®ä¿åå‘ä¼ æ’­æ—¶<code>target_q</code>çš„æ¢¯åº¦ä¸è¢«ä¼ æ’­å°±è¡Œã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>env</span> <span class=o>=</span> <span class=n>gym</span><span class=o>.</span><span class=n>make</span><span class=p>(</span><span class=s2>&#34;CartPole-v1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>batch_index</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>batch_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>epochs</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=c1># é‡‡æ · =========================================</span>
</span></span><span class=line><span class=cl>    <span class=n>epsilon</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>t</span> <span class=o>/</span> <span class=n>epochs</span>  <span class=c1># åŠ¨æ€è°ƒæ•´epsilon</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>batch_size</span><span class=o>//</span><span class=mi>4</span> <span class=k>if</span> <span class=n>t</span> <span class=o>&gt;=</span> <span class=mi>1</span> <span class=k>else</span> <span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>()</span> <span class=o>&lt;</span> <span class=n>epsilon</span><span class=p>:</span> <span class=c1># exploration</span>
</span></span><span class=line><span class=cl>            <span class=n>action</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>n_actions</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>action</span> <span class=o>=</span> <span class=n>net</span><span class=p>(</span><span class=n>state</span><span class=p>)</span><span class=o>.</span><span class=n>squeeze</span><span class=p>()</span><span class=o>.</span><span class=n>argmax</span><span class=p>()</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>org_state</span> <span class=o>=</span> <span class=n>state</span>
</span></span><span class=line><span class=cl>        <span class=n>state</span><span class=p>,</span> <span class=n>reward</span><span class=p>,</span> <span class=n>terminated</span><span class=p>,</span> <span class=n>truncated</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>action</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ä½¿ç”¨è‡ªå®šä¹‰çš„reward</span>
</span></span><span class=line><span class=cl>        <span class=n>reward</span> <span class=o>=</span> <span class=o>-</span><span class=mf>20.0</span> <span class=k>if</span> <span class=n>terminated</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mf>0.1</span><span class=p>:</span> <span class=c1># é™åˆ¶å€¾è§’</span>
</span></span><span class=line><span class=cl>            <span class=n>reward</span> <span class=o>+=</span> <span class=o>-</span><span class=mf>1.0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>state</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mf>0.3</span><span class=p>:</span> <span class=c1># é™åˆ¶ä½ç½®</span>
</span></span><span class=line><span class=cl>            <span class=n>reward</span> <span class=o>+=</span> <span class=o>-</span><span class=mf>2.0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>reward</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>reward</span> <span class=o>=</span> <span class=mf>1.0</span>
</span></span><span class=line><span class=cl>        <span class=c1># åŠ å…¥è®°å¿†</span>
</span></span><span class=line><span class=cl>        <span class=n>memory</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Experience</span><span class=p>(</span><span class=n>org_state</span><span class=p>,</span> <span class=n>action</span><span class=p>,</span> <span class=n>reward</span><span class=p>,</span> <span class=n>state</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>terminated</span> <span class=ow>or</span> <span class=n>truncated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>state</span><span class=p>,</span> <span class=n>info</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># è®­ç»ƒ =========================================</span>
</span></span><span class=line><span class=cl>    <span class=n>states</span><span class=p>,</span> <span class=n>actions</span><span class=p>,</span> <span class=n>rewards</span><span class=p>,</span> <span class=n>next_states</span> <span class=o>=</span> <span class=n>memory</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>batch_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># å‰å‘ä¼ æ’­</span>
</span></span><span class=line><span class=cl>    <span class=n>pred_q</span> <span class=o>=</span> <span class=n>net</span><span class=p>(</span><span class=n>states</span><span class=p>)[</span><span class=n>batch_index</span><span class=p>,</span> <span class=n>actions</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>target_q</span> <span class=o>=</span> <span class=p>(</span><span class=n>net</span><span class=p>(</span><span class=n>next_states</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>values</span> <span class=o>*</span> <span class=n>discount</span> <span class=o>+</span> <span class=n>rewards</span><span class=p>)</span><span class=o>.</span><span class=n>detach</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>loss</span> <span class=o>=</span> <span class=n>criterion</span><span class=p>(</span><span class=n>pred_q</span><span class=p>,</span> <span class=n>target_q</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># åå‘ä¼ æ’­</span>
</span></span><span class=line><span class=cl>    <span class=n>optimizer</span><span class=o>.</span><span class=n>zero_grad</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>loss</span><span class=o>.</span><span class=n>backward</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>utils</span><span class=o>.</span><span class=n>clip_grad_value_</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>optimizer</span><span class=o>.</span><span class=n>step</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>env</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># ä¿å­˜checkpoint</span>
</span></span><span class=line><span class=cl><span class=n>torch</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>state_dict</span><span class=p>(),</span> <span class=s2>&#34;cartpole-replay.ckpt&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å®Œæ•´ç¨‹åºè§ <a class=link href=https://gist.github.com/Furffico/7ce3f2ef1dc0bc42536d2a178c5c5a92#file-cartpole-replay-py target=_blank rel=noopener>Github Gist</a>ï¼Œè¿è¡Œç¨‹åºï¼Œå‘ç°ä¸¤ä¸ªç¨‹åºåœ¨<code>batch_size=128</code>å’Œ<code>epochs=5000</code>çš„æƒ…å†µä¸‹ï¼ŒåŸæ¥çš„ç¨‹åºåœ¨æˆ‘çš„è½»è–„æœ¬ä¸Šéœ€è¦è®­ç»ƒ 3 åˆ†é’Ÿï¼Œè€Œå¾—ç›Šäºæ‰¹å¤„ç†çš„è®­ç»ƒè¿‡ç¨‹ä»¥åŠé‡‡æ ·æ•°çš„å‡å°‘ï¼Œæœ‰ç»éªŒå›æ”¾çš„è®­ç»ƒåªè¦ 15 ç§’å°±èƒ½è¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</p><p><img src=https://files.furffisite.link/blogimg/20230823103323-8b5eae7fdc273354106f2effa166ee3c-fc680.gif loading=lazy></p><p>ç»§ç»­å¢åŠ <code>batch_size</code>æˆ–<code>epochs</code>ï¼Œæ•ˆæœæ›´ä½³ã€‚ä»¥ä¸‹æ˜¯<code>batch_size=256</code>ã€<code>epochs=5000</code>çš„ç»“æœï¼Œè®­ç»ƒåªèŠ±äº† 28 ç§’ã€‚</p><p><img src=https://files.furffisite.link/blogimg/20230823104647-a0f9ec917be67b838120250cf737771a-fcc8c.gif loading=lazy></p><h2 id=å‚è€ƒæ–‡çŒ®>å‚è€ƒæ–‡çŒ®</h2><style>.bibliography{display:table;font-size:medium;line-height:normal}.bib-item{display:table-row}.bib-item>:first-child{display:table-cell;padding-right:.5em;font-weight:700;text-align:right}.bib-item>:last-child{display:table-cell;padding-bottom:.5ex}</style><div class=bibliography><div id=cite1 class=bib-item><span>[1]</span>
<span>Mnih, V., Kavukcuoglu, K., Silver, D., Graves, A., Antonoglou, I., Wierstra, D., & Riedmiller, M. (2013). Playing Atari with Deep Reinforcement Learning (arXiv:1312.5602). arXiv. <a class=link href=https://doi.org/10.48550/arXiv.1312.5602 target=_blank rel=noopener>https://doi.org/10.48550/arXiv.1312.5602</a><a href=#ref-cite1-1>â¤¶</a></span></div><div id=cite2 class=bib-item><span>[2]</span>
<span>Mnih, V., Kavukcuoglu, K., Silver, D., Rusu, A. A., Veness, J., Bellemare, M. G., Graves, A., Riedmiller, M., Fidjeland, A. K., Ostrovski, G., Petersen, S., Beattie, C., Sadik, A., Antonoglou, I., King, H., Kumaran, D., Wierstra, D., Legg, S., & Hassabis, D. (2015). Human-level control through deep reinforcement learning. Nature, 518(7540), Article 7540. <a class=link href=https://doi.org/10.1038/nature14236 target=_blank rel=noopener>https://doi.org/10.1038/nature14236</a><a href=#ref-cite2-1>â¤¶</a><a href=#ref-cite2-2>â¤¶</a></span></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/>æœºå™¨å­¦ä¹ </a>
<a href=/tags/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/>å¼ºåŒ–å­¦ä¹ </a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>æœ¬æ–‡åŸºäº<a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.zh-Hans target=_blank rel=noopener><u>CC BY-NC-SA 4.0 åè®®</u></a>å‘å¸ƒã€‚æœ¬æ–‡<strong>ä¸å¯å•†ç”¨</strong>ï¼Œè½¬è½½æ—¶è¯·<strong>æ³¨æ˜å‡ºå¤„</strong>å¹¶ä½¿ç”¨<strong>ç›¸åŒåè®®</strong>ã€‚</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/q-learning/><div class=article-image><img src=https://files.furffisite.link/blogimg/20230518191643-b6c8849bfb006d40abef7203bb5e15a0-18b9a.jpg loading=lazy data-key=Q-learning data-hash=https://files.furffisite.link/blogimg/20230518191643-b6c8849bfb006d40abef7203bb5e15a0-18b9a.jpg></div><div class=article-details><h2 class=article-title>ã€RLå­¦ä¹ ç¬”è®°ã€‘Qå­¦ä¹ ç®—æ³•</h2></div></a></article><article class=has-image><a href=/p/read-papers/utsp/><div class=article-image><img src=https://files.furffisite.link/blogimg/20240312193735-df25ede3714c69d2ea8b42ba9c39f7c9-755f3.jpg loading=lazy data-key=read-papers/utsp data-hash=https://files.furffisite.link/blogimg/20240312193735-df25ede3714c69d2ea8b42ba9c39f7c9-755f3.jpg></div><div class=article-details><h2 class=article-title>ã€è¯»è®ºæ–‡ã€‘Unsupervised Learning for Solving the Travelling Salesman Problem</h2></div></a></article><article class=has-image><a href=/p/windows-setup/><div class=article-image><img src=https://files.furffisite.link/blogimg/20240707215654-5c276c9ae1c98340521bf56811f4b765-87c36.jpg loading=lazy data-key=windows-setup data-hash=https://files.furffisite.link/blogimg/20240707215654-5c276c9ae1c98340521bf56811f4b765-87c36.jpg></div><div class=article-details><h2 class=article-title>ä¸ªäººå¸¸ç”¨çš„æ–° Windows 11 ç³»ç»Ÿçš„é…ç½®è¿‡ç¨‹</h2></div></a></article><article class=has-image><a href=/p/applemusic-transfer/><div class=article-image><img src=https://files.furffisite.link/blogimg/20240523203808-9f4a7d937672d53fbc1a7174037c6f64-581fc.jpg loading=lazy data-key=applemusic-transfer data-hash=https://files.furffisite.link/blogimg/20240523203808-9f4a7d937672d53fbc1a7174037c6f64-581fc.jpg></div><div class=article-details><h2 class=article-title>Apple Music æ›²åº“è¿ç§»</h2></div></a></article><article class=has-image><a href=/p/nas-4/><div class=article-image><img src=https://files.furffisite.link/blogimg/20240310022612-8671164f59f21e5d03de82e41e7073d5-7f2c7.jpg loading=lazy data-key=nas-4 data-hash=https://files.furffisite.link/blogimg/20240310022612-8671164f59f21e5d03de82e41e7073d5-7f2c7.jpg></div><div class=article-details><h2 class=article-title>æˆ‘æŠ˜è…¾ NAS çš„å†ç¨‹ï¼ˆå››ï¼‰ï¼šä¸€äº›å‡çº§</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=Furffico/Furffico.github.io data-repo-id=R_kgDOIs6c3Q data-category=General data-category-id=DIC_kwDOIs6c3c4CTWXf data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2022 -
2024 Furffiblog</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://files.furffisite.link/fontcache/NotoSansSC_Mulish_remote.min.css",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>